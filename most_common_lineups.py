# NOTE: These lineups only correspond to 2014 - don't try to combine them with other years's data for a bunch of obvious reasons.

PITCHER = 'PITCHER_FLAG'

LINEUPS = {
    'LAA': [
        'Calhoun',
        'Trout',
        'Pujols',
        'Josh Hamilton',
        'Aybar',
        'Kendrick',
        'Freese',
        'Cron',
        'Conger'
    ],
    'BAL': [
        'Markakis',
        'Pearce',
        'Adam Jones',
        'Cruz',
        'Chris Davis',
        'Hardy',
        'Machado',
        'Joseph',
        'Schoop'
    ],
    'WSN': [
        'Span',
        'Rendon',
        'Werth',
        'LaRoche',
        'Desmond',
        'Harper',
        'Ramos',
        'Asdrubal Cabrera',
        PITCHER
    ],
    'LAD': [
        'Dee Gordon',
        'Puig',
        'Adrian Gonzalez',
        'Kemp',
        'Hanley Ramirez',
        'Carl Crawford',
        'Uribe',
        'Ellis',
        PITCHER
    ],
    'STL': [
        'Carpenter',
        'Wong',
        'Holliday',
        'Adams',
        'Jhonny Peralta',
        'Pierzynski',
        'Taveras',
        'Jay',
        PITCHER
    ],
    'DET': [
        'Kinsler',
        'Hunter',
        'Miguel Cabrera',
        'Victor Martinez',
        'J.D. Martinez',
        'Castellanos',
        'Avila',
        'Suarez',
        'Rajai Davis'
    ],
    'KCR': [
        'Aoki',
        'Infante',
        'Hosmer',
        'Butler',
        'Alex Gordon',
        'Perez',
        'Moustakas',
        'Alcides Escobar',
        'Dyson'
    ],
    'SFG': [
        'Pagan',
        'Belt',
        'Sandoval',
        'Posey',
        'Pence',
        'Morse',
        'Brandon Crawford',
        'Hicks',
        PITCHER
    ],
    'PIT': [
        'Marte',
        'Snider',
        'McCutchen',
        'Alvarez',
        'Russell Martin',
        'Walker',
        'Ishikawa',
        'Mercer',
        PITCHER
    ],
    'OAK': [
        'Crisp',
        'Lowrie',
        'Donaldson',
        'Moss',
        'Cespedes',
        'Callaspo',
        'Jaso',
        'Reddick',
        'Sogard'
    ],
    'SEA': [
        'Chavez',
        'James Jones',
        'Cano',
        'Seager',
        'Morrison',
        'Zunino',
        'Saunders',
        'Ackley',
        'Miller'
    ],
    'CLE': [
        'Kipnis',
        'Asdrubal Cabrera',
        'Brantley',
        'Carlos Santana',
        'Chisenhall',
        'Swisher',
        'David Murphy',
        'Yan Gomes',
        'Dickerson'
    ],
    'NYY': [
        'Gardner',
        'Jeter',
        'Ellsbury',
        'Teixeira',
        'McCann',
        'Beltran',
        'Ichiro Suzuki',
        'Roberts',
        'Kelly Johnson'
    ],
    'TOR': [
        'Reyes',
        'Melky Cabrera',
        'Bautista',
        'Lind',
        'Encarnacion',
        'Francisco',
        'Lawrie',
        'Thole',
        'Gose'
    ],
    'MIL': [
        'Weeks',
        'Braun',
        'Lucroy',
        'Gomez',
        'Aramis Ramirez',
        'Khris Davis',
        'Reynolds',
        'Segura',
        PITCHER
    ],
    'ATL': [
        'Melvin Upton',
        'Simmons',
        'Freeman',
        'Justin Upton',
        'Heyward',
        'Chris Johnson',
        'La*Stella',
        'Bethancourt',
        PITCHER
    ],
    'NYM': [
        'Granderson',
        'Daniel Murphy',
        'Wright',
        'Duda',
        "d'Arnaud",
        'den*Dekker',
        'Lagares',
        'Flores',
        PITCHER
    ],
    'SDP': [
        'Denorfia',
        'Headley',
        'Quentin',
        'Medica',
        'Rivera',
        'Conrad',
        'Maybin',
        'Amarista',
        PITCHER
    ],
    'MIA': [
        'Yelich',
        'Solano',
        'Stanton',
        'McGehee',
        'Garrett Jones',
        'Ozuna',
        'Saltalamacchia',
        'Hechavarria',
        PITCHER
    ],
    'TBR': [
        'Zobrist',
        'Jennings',
        'Joyce',
        'Longoria',
        'Loney',
        'Myers',
        'DeJesus',
        'Yunel Escobar',
        'Hanigan'
    ],
    'CIN': [
        'Billy Hamilton',
        'Frazier',
        'Votto',
        'Phillips',
        'Bruce',
        'Mesoraco',
        'Schumaker',
        'Cozart',
        PITCHER
    ],
    'CHW': [
        'Eaton',
        'Beckham',
        'Gillaspie',
        'Abreu',
        'Dunn',
        'Alexei Ramirez',
        'Viciedo',
        'De*Aza',
        'Flowers'
    ],
    'CHC': [
        'Bonifacio',
        'Lake',
        'Rizzo',
        'Starlin Castro',
        'Valbuena',
        'Schierholtz',
        'Coghlan',
        'Baker',
        PITCHER
    ],
    'PHI': [
        'Revere',
        'Rollins',
        'Utley',
        'Howard',
        'Byrd',
        'Brown',
        'Ruiz',
        'Asche',
        PITCHER
    ],
    'BOS': [
        'Pedroia',
        'Victorino',
        'Ortiz',
        'Napoli',
        'Sizemore',
        'Bogaerts',
        'Pierzynski',
        'Middlebrooks',
        'Bradley'
    ],
    'HOU': [
        'Altuve',
        'Fowler',
        'Jason Castro',
        'Springer',
        'Krauss',
        'Presley',
        'Carter',
        'Dominguez',
        'Villar'
    ],
    'MIN': [
        'Danny Santana',
        'Dozier',
        'Mauer',
        'Vargas',
        'Arcia',
        'Plouffe',
        'Kurt Suzuki',
        'Eduardo Escobar',
        'Schafer'
    ],
    'TEX': [
        'Choo',
        'Andrus',
        'Rios',
        'Beltre',
        'Adduci',
        'Arencibia',
        'Leonys Martin',
        'Chirinos',
        'Odor'
    ],
    'COL': [
        'Blackmon',
        'Stubbs',
        'Morneau',
        'Arenado',
        'Dickerson',
        'McKenry',
        'Rutledge',
        'LeMahieu',
        PITCHER
    ],
    'ARI': [
        'Pollock',
        'Hill',
        'Goldschmidt',
        'Prado',
        'Trumbo',
        'Montero',
        'Owings',
        'Parra',
        PITCHER
    ]
}


def map_to_players(lineup, player_set):
    return map(lambda x: _map_to_player_force(x, player_set), lineup)


def _map_to_player_force(p, player_set):
    poss_players = _map_to_matching_players(p, player_set)
    if len(poss_players) == 0:
        print p
    return poss_players[0]


def _map_to_matching_players(p, player_set):
    split_names = p.split(' ')
    if len(split_names) > 1:
        first_name, last_name = split_names
    else:
        last_name = split_names[0].replace('*', ' ')
        first_name = None

    def name_filter(p):
        is_match = True
        if first_name:
            if p.first_name != first_name:
                is_match = False
        if p.last_name != last_name:
            is_match = False
        return is_match

    return filter(name_filter, player_set)


def validate_lineups(player_set):
    missing_players = 0
    dupe_players = 0
    incomplete_teams = set()
    for team in LINEUPS:
        print "Validating {}".format(team)
        for player in LINEUPS[team]:
            if player == PITCHER:
                continue
            players_with_matching_name = _map_to_matching_players(player)
            if len(players_with_matching_name) == 1:
                # player is validated
                pass
            elif len(players_with_matching_name) == 0:
                incomplete_teams.add(team)
                missing_players += 1
                print "Cannot find player {} {}".format(first_name, last_name)
            else:
                incomplete_teams.add(team)
                dupe_players += 1
                print "Multiple possible players for {} {}".format(first_name, last_name)

    print "Missing players: {}".format(missing_players)
    print "Dupe players: {}".format(dupe_players)
    print "Incomplete teams: {}".format(incomplete_teams)

INCOMPLETE_TEAMS = {'SDP', 'MIN', 'TOR', 'ATL', 'BOS', 'TEX', 'STL', 'HOU', 'NYM', 'PIT', 'COL'}